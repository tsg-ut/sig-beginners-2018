# TSG2018年Sセメスター初心者分科会\#4

実は今までやってきた内容はほぼほぼ他の言語と共通の内容です。今日はちょっとextraな内容に入っていきます。

### 三項演算子
```python
>>> 1 if True else 0
1
>>> 1 if True else 2
1
>>> 1 if False else 2
2
```
三項演算子というif文を省略した構文が存在します。最初にifの中が評価され、その結果右か左の結果を用います。そのため、左右で異なる型があっても動作します。
```python
>>> 1 if False else "1"
'1'
```
また、ifをつなげることも可能です。
```python
>>> "x<3" if x<3 else "x>3" if x>3 else "x==3"
'x==3'
```

### リスト内包表記
```python
>>> [3*x for x in range(1,10)] #リストの中でループを回してる
[3, 6, 9, 12, 15, 18, 21, 24, 27]
>>> [3*x for x in range(1,50) if x%5==0] #ifも入れられる
[15, 30, 45, 60, 75, 90, 105, 120, 135]
>>> [[0]*5 for i in range(5)] # 2次元配列はこういう書き方になる
[[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]
>>> [[0]*5]*5 #こっちはバグる
[[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]
```
という感じの無茶苦茶な構文があります。配列の中身をループで作ろうと。実はかなり高速です。

また、ifを用いることで、フィルターを付けることが出来ます。このフィルターを通った要素だけが配列に残ります。

```python
>>> [3*x if x%5==0 for x in range(1,50)] #順番に注意
  File "<stdin>", line 1
    [3*x if x%5==0 for x in range(1,50)]
                     ^
SyntaxError: invalid syntax
```
ただ、順番に気を付けてください。というのも、後者のifは三項演算子です。

__練習問題__

fizzbuzzは覚えていますか？三項演算子、及びリスト内包表記で1~100まで「1行で」書いてください。
```python
# 書き方のイメージ
print("\n".join([中身は全てstrに変換が必要です。]))
```
以下答え
```python
print("\n".join(["FizzBuzz" if i%15==0 else "Fizz" if i%3==0 else "Buzz" if i%5==0 else str(i) for i in range(1,101)]))
```

### ラムダ式
今までifと配列(for)の簡略表記を見てきました。実は関数にもあります。無名関数・ラムダ式です（かっこいい）。
```python
>>> f = lambda x:x*x
>>> f(3)
9
>>> f = lambda x,y: x**y
>>> f(3,4)
81
```
このfは関数で、
```python
def f(x):
    return x*x
```
と同じです。

普通に再帰も書けます。
```python
>>> f = lambda x: 1 if x<2 else x*f(x-1)
>>> f
<function <lambda> at 0x06147270>
>>> f(10)
3628800
```
ただ、難点が1つ。1行でしか書けません。そのため、変数宣言とかで苦労します。

一応解説しておくと、Pythonでは関数すらオブジェクトとして処理します。そのため、上の中で`g=f`なんて入れるとgも関数になります。

__練習問題__

fizzbuzzをlambda式で書いてください。（出来れば再帰関数で。リスト内包表記を使えば余裕なんですよね…）

print(f(1,100))と呼んで、1～100まで実行してもらいます。

```python
f = lambda x,n:"" if x>n else ("fizzbuzz\n" if x%15==0 else "fizz\n" if x%3==0 else "buzz\n" if x%5==0 else str(x)+"\n")+f(x+1,n)
print(f(1,100))
```

### 復習
今までの内容を踏まえて、以下の問題に挑戦してみましょう。

少し前に、以下の記事が流行りました。

[ランダム出力で「ポプテピピック」が完成したら竹●房を破壊するJavaScript登場　文字を眺めて竹生会をドゴォ！](http://nlab.itmedia.co.jp/nl/articles/1803/27/news124.html)

楽しそうですよね（狂気）

ということで、標準入力で「ポ」「プ」「テ」「ピピック」をランダムに生成していきます。「ポプテピピック」が並んだ瞬間に竹●房を破壊してください。この後やろうと思っている内容を少し先取りしますが…

標準入力は以下のコードを用いてください。
```python
import random #1行目に入れてください
s = random.choice(["ポ","プ","テ","ピピック"]) # sに入力を代入します
```

で、入力は毎回出力し、揃った瞬間に竹●房を破壊してプログラムを終了してください。等幅フォントを強く推奨します。

例
```
ピピック
ピピック
ポ
ポ
ポ
ポ
ポ
プ
テ
ピピック

　　　　　　　　　　　　　　　　　　　　　　　　　-------　､　ｒへ------､
　　　　　　　　　　　　　　　　　　 ＿__､+''"~　八 　　　　　~''＜ つ　　　＼
　　　　　　　　　　　　　　 _､+''"~　 ./ ,:　　　　＾ 　 丶　　　　　ヽく＿＿　∧
　　　　　　 , -r-　　　　 / 　 　 　 / / -､　　　　'´￣!＼‘,　‘:,　 |　　　 ＼/
　　　　　／ .∧　　 ＼..ﾞ|/＿,,.｡*'/ /|,/＼＿_／^ヽ /,,_　`! 　 ',　|
　　　 ／　　　∧　　　 ＼　〈〉.　,　.|　ｙ''"ヽ______ 7´⌒ヽ _|　　ト;′
　　 〈　　　　　 ∧ （竹） .∨...　｜｜ ,r　ヽ 三三/　　‘:, Y!　 .|,′
　　　∨ 　 　 　 ∧　　　　∨...　|　.|八 °,!三三{.　° ﾉ 八　/---､
.　　　 ∨ 　 　 　 ∧　　　　∨....∨（.＾ 　　 ､_,､_, `　　　,.ｨ^!./＿　　',
　　　　 ∨　　 ／三ﾐメ、　　∨　冫≧=‐------‐ｧ=≦/ .|/　　 } 　 !
.　　　 　 ∨三三三三圦__.＼＼/　＼|ｲ `''＜:＼/:::::／　　|　　（＿__）
　　　 〈〉　　 ノ　ゞ三ｼ.　＼　＼;　　 { /　　　 ｀¨ﾍ⌒こフ　.∨ 〔､､､_）
　　　　　　　）　　　 　 　 　 ＼八　　`^i､_ __　　　 ＼＼　　 .∨ ｀¨´
　　　　 ＜ﾍ＿/三＼＿／｜＼､.＼　/::/　 ）　　　　 `'´　＿ ,∨､
　　　　|＼三三三三:／　　|.　　＼/^ゞク≦---‐=≦::::::「:::::::::|::::/
　　　　　　　　 　 　 　 　 　 　 　 /:::::::/:::::::/:::::::::;′:::::::::|::::::::::|:人
```

### import
https://docs.python.jp/3/library/math.html

みたいなものを見ると、色々あります。説明しきれないので使い方だけ。便利な機能がいっぱいあるので、「こんな機能ないかなー」と思ったら検索しましょう
```python
>>> import math # mathを使いますという宣言
>>> math.factorial(100) # math.(使いたいやつ)で使う
93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000
>>> from random import choice # randomの中のchoiceを使いますという宣言
>>> choice([3,4,5]) # fromを使った場合はmathやrandomは不要
4
>>> from random import * # randomの中身全部使いますという宣言
>>> random() # 呼び出されたのはrandom.random（0-1の乱数を返す）
0.47800637793418244
```